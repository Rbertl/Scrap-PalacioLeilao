name: Atualiza칞칚o Di치ria do Leil칚o

on:
  schedule:
    # Roda todos os dias 맙 09:00 UTC (06:00 da manh칚 no Brasil)
    - cron: '0 9 * * *'
  workflow_dispatch: # Permite voc칡 clicar num bot칚o "Run" para rodar manualmente se quiser

permissions:
  contents: write

jobs:
  scraping-job:
    runs-on: ubuntu-latest

    steps:
    - name: 游닌 Baixar c칩digo do reposit칩rio
      uses: actions/checkout@v3

    - name: 游냀 Configurar Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
        cache: 'pip' # Faz cache das libs para ser mais r치pido nas pr칩ximas vezes

    - name: 游닍 Instalar depend칡ncias
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    - name: 游꿠 Instalar Navegadores (Playwright)
      run: |
        playwright install chromium
        playwright install-deps

    - name: 游 Rodar Scraping e IA
      run: python run_automacao.py

    - name: 游 Salvar dados atualizados no Git
      run: |
        git config --global user.name 'Robo Leilao'
        git config --global user.email 'robo@actions.github.com'
        git add data/dados_brutos.json
        git add data/dados_processados.json
        git add data/embeddings.pkl
        # S칩 commita se houver mudan칞as
        git commit -m "Atualiza칞칚o autom치tica: $(date +'%Y-%m-%d')" || echo "Sem mudan칞as novas"
        git push